<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生日 | 大大的小蜗牛</title>
    
    <link rel=apple-touch-icon sizes=180x180 href=https://www.eallion.com/apple-touch-icon.png>
    <link rel=icon type=image/png sizes=32x32 href=https://www.eallion.com/favicon-32x32.png>
    <link rel=icon type=image/png sizes=16x16 href=https://www.eallion.com/favicon-16x16.png>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Anton+SC&family=JetBrains+Mono:wght@800&display=swap');
        :root {
            --vh: 1vh;
        }
        body {
            font-family: ui-sans-serif, system-ui, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: calc(var(--vh, 1vh) * 100);
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            margin: 0;
            padding: 0;
            font-family: sans-serif;
            font-weight: bold;
        }

        .main {
            text-align: center;
        }

        h1 {
            font-family: "Anton SC", sans-serif;
            font-weight: 400;
            font-style: normal;
            font-size: 80px;
            margin: 0 0 50px;
            color: #333;
        }

        h3 {
            font-size: 64px;
            color: #555;
            margin: 0;
        }

        .desc {
            font-weight: normal;
            font-size: 36px;
            display: flex;
            text-align: center;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            color: #555;
            margin-bottom: 50px;
        }

        .desc-span {
            font-weight: bold;
            text-decoration: underline;
        }

        #flipdown {
            font-family: "JetBrains Mono", monospace;
            font-optical-sizing: auto;
            font-weight: 800;
            font-style: normal;
            overflow: visible;
            width: 100%;
            height: 110px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
        }

        .rotor-group {
            position: relative;
            float: left;
            display: flex;
            flex-direction: row;
            align-items: center;
            flex-wrap: nowrap;
            justify-content: center;
            margin-top: 20px;
        }

        .rotor-group:last-child {
            padding-right: 0;
        }

        .rotor-group-heading:before {
            display: block;
            height: 30px;
            line-height: 30px;
            text-align: center;
            color: #000000;
        }

        .rotor {
            position: relative;
            float: left;
            width: 50px;
            height: 80px;
            margin: 0px 5px 0px 0px;
            border-radius: 4px;
            font-size: 4rem;
            text-align: center;
            perspective: 200px;
            color: #FFFFFF;
            background-color: #151515;
            line-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .rotor:last-child {
            margin-right: 0;
        }

        .rotor-top,
        .rotor-bottom {
            overflow: hidden;
            position: absolute;
            width: 50px;
            height: 40px;
        }

        .rotor-leaf {
            z-index: 1;
            position: absolute;
            width: 50px;
            height: 80px;
            transform-style: preserve-3d;
            transition: transform 0s;
        }

        .rotor-leaf.flipped {
            transform: rotateX(-180deg);
            transition: all 0.5s ease-in-out;
        }

        .rotor-leaf-front,
        .rotor-leaf-rear {
            overflow: hidden;
            position: absolute;
            width: 50px;
            height: 40px;
            margin: 0;
            transform: rotateX(0deg);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        .rotor-leaf-front {
            line-height: 80px;
            border-radius: 4px 4px 0px 0px;
        }

        .rotor-leaf-rear {
            line-height: 0px;
            border-radius: 0px 0px 4px 4px;
            transform: rotateX(-180deg);
            color: #EFEFEF;
            background-color: #202020;
        }

        .rotor-top {
            line-height: 80px;
            border-radius: 4px 4px 0px 0px;
        }

        .rotor-bottom {
            bottom: 0;
            line-height: 0px;
            border-radius: 0px 0px 4px 4px;
            color: #EFEFEF;
            background-color: #202020;
        }

        .rotor:after {
            content: '';
            z-index: 2;
            position: absolute;
            bottom: 0px;
            left: 0px;
            width: 50px;
            height: 40px;
            border-radius: 0px 0px 4px 4px;
            border-top: solid 1px #151515;
        }

        .rotor-colon {
            position: relative;
            width: 10px; 
            height: 80px; 
            display: inline-block;
            margin-right: 10px;
            margin-left: -5px;
        }

        .rotor-colon:before,
        .rotor-colon:after {
            content: '';
            position: absolute;
            width: 100%;
            height: 30px; 
            background-color: black; 
            border-radius: 50%;
            width: 10px;
            height: 10px;
        }

        .rotor-colon:before {
            top: 18px;
        }

        .rotor-colon:after {
            bottom: 18px;
        }

        .rotor-day {
            width: 100%;
        }

        .rotor-day::after {
            width: 100%;
        }
        
        @media only screen and (max-width: 640px) and (hover: none) and (pointer: coarse) {
            body {
                display: flex;
                align-items: flex-start;
            }
            h1 {
                font-size: 60px;
            }
            h3 {
                font-size: 48px;
                margin-top: 40px;
            }
            .desc {
                font-size: 20px;
            }
        }
        footer {
            position: absolute;
            bottom: 10px;
            font-weight: 300;
        }
    </style>
</head>

<body>
    <div class="main">
        <h3>Birthday</h3>
        <h1>Charles Chin</h1>
        <div class="desc">
            <div>蜗牛出生于 22 May 1986 17:05:00</div>
            <div>距今已&nbsp;<span id="date"></span></div>
        </div>
        <div id="flipdown" class="flipdown"></div>
    </div>
    <footer>
        &copy; 1986 - <span id="copyright-year"></span> Charles Chin.
    </footer>
    <script>
        function setVh() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        window.addEventListener('resize', setVh);
        setVh();
    </script>
    <script>
        let externalTime = null;
        let lastUpdated = null;

        async function getExternalTime() {
            try {
                const response = await fetch('https://v2.jinrishici.com/info');
                const data = await response.json();
                return new Date(data.data.beijingTime);
            } catch (error) {
                console.error('Error fetching external time:', error);
                
                return new Date();
            }
        }

        async function updateTimer() {
            if (!externalTime) {
                externalTime = await getExternalTime();
                lastUpdated = new Date();
            }

            const now = new Date();
            const elapsedTime = now - lastUpdated;
            const currentTime = new Date(externalTime.getTime() + elapsedTime);

            const currentYear = currentTime.getFullYear();
            const currentMonth = currentTime.getMonth();
            const currentDay = currentTime.getDate();
            const currentHour = currentTime.getHours();
            const currentMinute = currentTime.getMinutes();
            const currentSecond = currentTime.getSeconds();

            let years = currentYear - 1986;
            let months = currentMonth;
            let days = currentDay - 22;
            let hours = currentHour;
            let minutes = currentMinute;
            let seconds = currentSecond;

            // Adjust years if current time is before May 22 of the current year
            if (currentMonth < 4 || (currentMonth === 4 && currentDay < 22)) {
                years--;
            }

            // Adjust months based on the current time
            if (currentMonth < 4) {
                months += 8; // 12 - 4
            } else {
                months -= 4;
            }

            // Adjust days based on the current time
            if (currentDay < 22) {
                months--;
                days += new Date(currentYear, currentMonth, 0).getDate();
            }

            // Adjust hours and minutes based on the anchor time 17:05
            if (currentHour < 17 || (currentHour === 17 && currentMinute < 5)) {
                if (currentHour < 17) {
                    hours += 24 - 17;
                } else {
                    hours += 24 - 17 - 1;
                }
                days--;
            } else {
                hours -= 17;
            }

            if (currentMinute < 5) {
                minutes += 60 - 5;
                hours--;
            } else {
                minutes -= 5;
            }

            const hoursStr = pad(hours, 2);
            const hoursFirstDigit = hoursStr[0];
            const hoursSecondDigit = hoursStr[1];
            const minutesStr = pad(minutes, 2);
            const minutesFirstDigit = minutesStr[0];
            const minutesSecondDigit = minutesStr[1];
            const secondsStr = pad(seconds, 2);
            const secondsFirstDigit = secondsStr[0];
            const secondsSecondDigit = secondsStr[1];

            const currentTimestamp = new Date();
            const targetTime = new Date(517133100000);
            const diffInMilliseconds = currentTime - targetTime;
            const diffInDays = Math.floor(diffInMilliseconds / (1000 * 60 * 60 * 24));

            document.getElementById('date').innerHTML = `<span class="desc-span">${pad(years)}</span> 年 <span class="desc-span">${pad(months)}</span> 个月 <span class="desc-span">${pad(days)}</span> 天`;
            document.getElementById('flipdown').innerHTML = `
                <div class="rotor-group">
                    <div class="rotor-group-heading" data-before="Days"></div>
                    <div class="rotor rotor-day">共</div>
                    <div class="rotor rotor-day">${diffInDays}</div>
                    <div class="rotor rotor-day">天</div>
                </div>
                <div class="rotor-group">
                    <div class="rotor-group-heading" data-before="Hours"></div>
                    <div class="rotor">${hoursFirstDigit}</div>
                    <div class="rotor">${hoursSecondDigit}</div>
                    <div class="rotor-colon"></div>
                    <div class="rotor">${minutesFirstDigit}</div>
                    <div class="rotor">${minutesSecondDigit}</div>
                    <div class="rotor-colon"></div>
                    <div class="rotor">${secondsFirstDigit}</div>
                    <div class="rotor">${secondsSecondDigit}</div>
                </div>
            `;
            document.getElementById('copyright-year').textContent = currentYear;
        }

        function pad(n, len) {
            n = n.toString();
            return n.length < len ? pad("0" + n, len) : n;
        }

        setInterval(updateTimer, 1000);
        updateTimer();
    </script>

</body>

</html>
